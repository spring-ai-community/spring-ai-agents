<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>AgentClient API :: Spring AI Agents Reference</title>
    <link rel="canonical" href="https://spring-ai-community.github.io/spring-ai-agents/spring-ai-agents/main/api/agentclient.html">
    <meta name="generator" content="Antora 3.1.12">
    <link rel="stylesheet" href="../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://spring-ai-community.github.io/spring-ai-agents">Spring AI Agents Reference</a>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="spring-ai-agents" data-version="main">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">Spring AI Agents</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../getting-started.html">Getting Started</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="agentclient.html">AgentClient API</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="agentclient-vs-chatclient.html">AgentClient vs ChatClient</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="claude-code-sdk.html">Claude Code SDK</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="gemini-cli-sdk.html">Gemini CLI SDK</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../samples.html">Sample Agents</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../contribution-guidelines.html">Contribution Guidelines</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Spring AI Agents</span>
    <span class="version">main</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="../index.html">Spring AI Agents</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">main</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Spring AI Agents</a></li>
    <li><a href="agentclient.html">AgentClient API</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="file:///home/mark/claude/bud/experiments/spring-ai-agents/community-output/docs/src/main/antora/modules/ROOT/pages/api/agentclient.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">AgentClient API</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_creating_an_agentclient">1. Creating an AgentClient</a></li>
<li><a href="#_basic_usage">2. Basic Usage</a>
<ul class="sectlevel2">
<li><a href="#_simple_goal_execution">2.1. Simple Goal Execution</a></li>
<li><a href="#_fluent_api_configuration">2.2. Fluent API Configuration</a></li>
</ul>
</li>
<li><a href="#_configuration_options">3. Configuration Options</a>
<ul class="sectlevel2">
<li><a href="#_working_directory">3.1. Working Directory</a></li>
<li><a href="#_yolo_mode">3.2. YOLO Mode</a></li>
<li><a href="#_agent_specific_options">3.3. Agent-Specific Options</a></li>
</ul>
</li>
<li><a href="#_response_handling">4. Response Handling</a>
<ul class="sectlevel2">
<li><a href="#_agentclientresponse">4.1. AgentClientResponse</a></li>
<li><a href="#_error_handling">4.2. Error Handling</a></li>
</ul>
</li>
<li><a href="#_spring_boot_integration">5. Spring Boot Integration</a>
<ul class="sectlevel2">
<li><a href="#_dependency_injection">5.1. Dependency Injection</a></li>
<li><a href="#_controller_usage">5.2. Controller Usage</a></li>
</ul>
</li>
<li><a href="#_best_practices">6. Best Practices</a>
<ul class="sectlevel2">
<li><a href="#_goal_formulation">6.1. Goal Formulation</a></li>
<li><a href="#_working_directory_management">6.2. Working Directory Management</a></li>
<li><a href="#_resource_management">6.3. Resource Management</a></li>
</ul>
</li>
<li><a href="#_advanced_features">7. Advanced Features</a>
<ul class="sectlevel2">
<li><a href="#_timeout_configuration">7.1. Timeout Configuration</a></li>
<li><a href="#_result_streaming">7.2. Result Streaming</a></li>
</ul>
</li>
<li><a href="#_next_steps">8. Next Steps</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The <code>AgentClient</code> offers a fluent API for communicating with autonomous agents. It provides a familiar interface for Spring developers, following the same patterns as Spring AI&#8217;s <code>ChatClient</code>.</p>
</div>
<div class="paragraph">
<p>The fluent API allows you to build up goal requests that are passed to autonomous agents. Unlike traditional chat models that process conversational prompts, autonomous agents execute goals that can involve reading files, running commands, and making code changes.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_an_agentclient"><a class="anchor" href="#_creating_an_agentclient"></a>1. Creating an AgentClient</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>AgentClient</code> is created using an <code>AgentModel</code> instance. Here is a simple example showing the complete flow:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.springaicommunity.agents.client.AgentClient;
import org.springaicommunity.agents.client.AgentClientResponse;
import org.springaicommunity.agents.claudecode.ClaudeCodeAgentModel;
import org.springaicommunity.agents.claudecode.ClaudeCodeAgentOptions;
import org.springaicommunity.agents.claudecode.sdk.ClaudeCodeClient;

public class HelloAgentWorld {
    public static void main(String[] args) {
        // 1. Create the Claude Code client
        ClaudeCodeClient claudeClient = ClaudeCodeClient.create();

        // 2. Configure agent options
        ClaudeCodeAgentOptions options = ClaudeCodeAgentOptions.builder()
            .model("claude-sonnet-4-0")
            .yolo(true)
            .build();

        // 3. Create the agent model
        ClaudeCodeAgentModel agentModel = new ClaudeCodeAgentModel(claudeClient, options);

        // 4. Create AgentClient
        AgentClient agentClient = AgentClient.create(agentModel);

        // 5. Execute a goal
        AgentClientResponse response = agentClient.run(
            "Create a simple Hello World Java class"
        );

        // 6. Use the result
        System.out.println("Goal completed: " + response.isSuccessful());
        System.out.println("Result: " + response.getResult());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>We create a <code>ClaudeCodeClient</code> that manages communication with the Claude CLI</p>
</li>
<li>
<p>We configure options like the model to use and whether to allow changes (<code>yolo</code>)</p>
</li>
<li>
<p>We wrap the client in a <code>ClaudeCodeAgentModel</code> for Spring AI integration</p>
</li>
<li>
<p>We create an <code>AgentClient</code> using the agent model</p>
</li>
<li>
<p>We run a simple goal using the <code>.run()</code> method</p>
</li>
<li>
<p>We access the results and check if the goal was successful</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_basic_usage"><a class="anchor" href="#_basic_usage"></a>2. Basic Usage</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_simple_goal_execution"><a class="anchor" href="#_simple_goal_execution"></a>2.1. Simple Goal Execution</h3>
<div class="paragraph">
<p>The simplest way to run a goal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Assuming you have an AgentClient created as shown above
AgentClientResponse response = agentClient.run("Create a Hello World Java class");

System.out.println("Result: " + response.getResult());
System.out.println("Success: " + response.isSuccessful());</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_fluent_api_configuration"><a class="anchor" href="#_fluent_api_configuration"></a>2.2. Fluent API Configuration</h3>
<div class="paragraph">
<p>For more control over execution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">AgentClientResponse response = agentClient
    .prompt("Refactor the UserService class to use dependency injection")
    .workingDirectory("/path/to/project")
    .yolo(true)
    .call();</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_options"><a class="anchor" href="#_configuration_options"></a>3. Configuration Options</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_working_directory"><a class="anchor" href="#_working_directory"></a>3.1. Working Directory</h3>
<div class="paragraph">
<p>Set the directory where the agent operates:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Using string path
agentClient.prompt("Generate unit tests")
    .workingDirectory("/home/user/my-project")
    .call();

// Using Path object
Path projectPath = Paths.get(System.getProperty("user.dir"));
agentClient.prompt("Generate unit tests")
    .workingDirectory(projectPath)
    .call();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_yolo_mode"><a class="anchor" href="#_yolo_mode"></a>3.2. YOLO Mode</h3>
<div class="paragraph">
<p>Enable or disable the agent&#8217;s ability to make changes without confirmation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Enable YOLO mode for development
agentClient.prompt("Fix all compilation errors")
    .yolo(true)
    .call();

// Disable for safe analysis
agentClient.prompt("Analyze code quality issues")
    .yolo(false)
    .call();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_agent_specific_options"><a class="anchor" href="#_agent_specific_options"></a>3.3. Agent-Specific Options</h3>
<div class="paragraph">
<p>Configure agent-specific behavior:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ClaudeCodeAgentOptions options = ClaudeCodeAgentOptions.builder()
    .model("claude-sonnet-4-0")
    .maxTokens(8192)
    .timeout(Duration.ofMinutes(10))
    .build();

agentClient.prompt("Generate comprehensive documentation")
    .options(options)
    .call();</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_response_handling"><a class="anchor" href="#_response_handling"></a>4. Response Handling</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_agentclientresponse"><a class="anchor" href="#_agentclientresponse"></a>4.1. AgentClientResponse</h3>
<div class="paragraph">
<p>The response object provides access to results and metadata:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">AgentClientResponse response = agentClient.run("Generate a README file");

// Check if goal completed successfully
if (response.isSuccessful()) {
    String result = response.getResult();
    System.out.println("Agent completed: " + result);
} else {
    System.err.println("Goal failed: " + response.getResult());
}

// Access metadata
AgentResponseMetadata metadata = response.getMetadata();
Duration duration = metadata.getDuration();
String model = metadata.getModel();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_error_handling"><a class="anchor" href="#_error_handling"></a>4.2. Error Handling</h3>
<div class="paragraph">
<p>Handle various error conditions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">try {
    AgentClientResponse response = agentClient.run("Complex refactoring goal");

    if (!response.isSuccessful()) {
        // Goal completed but failed
        System.err.println("Agent reported failure: " + response.getResult());
    }

} catch (AgentExecutionException e) {
    // Agent process failed to start or crashed
    System.err.println("Execution error: " + e.getMessage());

} catch (AgentTimeoutException e) {
    // Goal exceeded timeout
    System.err.println("Goal timed out after: " + e.getTimeout());
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_spring_boot_integration"><a class="anchor" href="#_spring_boot_integration"></a>5. Spring Boot Integration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_dependency_injection"><a class="anchor" href="#_dependency_injection"></a>5.1. Dependency Injection</h3>
<div class="paragraph">
<p>Configure AgentClient as a Spring bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
public class AgentConfiguration {

    @Bean
    public ClaudeCodeClient claudeCodeClient() {
        return ClaudeCodeClient.create(Paths.get(System.getProperty("user.dir")));
    }

    @Bean
    public ClaudeCodeAgentModel claudeCodeAgentModel(ClaudeCodeClient client) {
        ClaudeCodeAgentOptions options = ClaudeCodeAgentOptions.builder()
            .model("claude-sonnet-4-0")
            .yolo(false) // Safe for production
            .build();
        return new ClaudeCodeAgentModel(client, options);
    }

    @Bean
    public AgentClient agentClient(ClaudeCodeAgentModel agentModel) {
        return AgentClient.create(agentModel);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_controller_usage"><a class="anchor" href="#_controller_usage"></a>5.2. Controller Usage</h3>
<div class="paragraph">
<p>Use in REST controllers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@RestController
public class DevelopmentController {

    private final AgentClient agentClient;

    public DevelopmentController(AgentClient agentClient) {
        this.agentClient = agentClient;
    }

    @PostMapping("/generate-tests")
    public ResponseEntity&lt;String&gt; generateTests(@RequestBody GenerateTestsRequest request) {
        try {
            AgentClientResponse response = agentClient
                .prompt("Generate unit tests for " + request.getClassName())
                .workingDirectory(request.getProjectPath())
                .yolo(false) // Safe mode for production
                .call();

            if (response.isSuccessful()) {
                return ResponseEntity.ok(response.getResult());
            } else {
                return ResponseEntity.badRequest().body(response.getResult());
            }

        } catch (Exception e) {
            return ResponseEntity.status(500).body("Goal execution failed: " + e.getMessage());
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_best_practices"><a class="anchor" href="#_best_practices"></a>6. Best Practices</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_goal_formulation"><a class="anchor" href="#_goal_formulation"></a>6.1. Goal Formulation</h3>
<div class="paragraph">
<p>Write clear, specific goals:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Good: Specific and actionable
client.run("Add input validation to the UserController.createUser() method");

// Poor: Vague and ambiguous
client.run("Make the code better");</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_working_directory_management"><a class="anchor" href="#_working_directory_management"></a>6.2. Working Directory Management</h3>
<div class="paragraph">
<p>Always set appropriate working directories:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// For multi-module projects
client.prompt("Generate integration tests")
    .workingDirectory(projectRoot.resolve("service-module"))
    .call();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_resource_management"><a class="anchor" href="#_resource_management"></a>6.3. Resource Management</h3>
<div class="paragraph">
<p>AgentClient instances are thread-safe and can be reused:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Component
public class CodeGenerationService {

    private final AgentClient agentClient;

    public CodeGenerationService(AgentClient agentClient) {
        this.agentClient = agentClient;
    }

    // Reuse the same client instance across methods
    public String generateController(String entityName) {
        return agentClient.run("Generate REST controller for " + entityName).getResult();
    }

    public String generateTests(String className) {
        return agentClient.run("Generate unit tests for " + className).getResult();
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_advanced_features"><a class="anchor" href="#_advanced_features"></a>7. Advanced Features</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_timeout_configuration"><a class="anchor" href="#_timeout_configuration"></a>7.1. Timeout Configuration</h3>
<div class="paragraph">
<p>Configure execution timeouts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">AgentOptions options = AgentOptions.builder()
    .timeout(Duration.ofMinutes(15)) // Long-running refactoring goal
    .build();

client.prompt("Refactor entire codebase to use reactive patterns")
    .options(options)
    .call();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_result_streaming"><a class="anchor" href="#_result_streaming"></a>7.2. Result Streaming</h3>
<div class="paragraph">
<p>For long-running tasks, some agents support progress updates:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Note: Streaming support varies by agent implementation
AgentClientResponse response = client
    .prompt("Generate comprehensive test suite")
    .options(AgentOptions.builder().streaming(true).build())
    .call();

// Implementation-specific streaming access
if (response instanceof StreamingAgentResponse streaming) {
    streaming.getProgressUpdates().forEach(System.out::println);
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_next_steps"><a class="anchor" href="#_next_steps"></a>8. Next Steps</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Learn how AgentClient compares to ChatClient in <a href="agentclient-vs-chatclient.html" class="xref page">AgentClient vs ChatClient</a></p>
</li>
<li>
<p>Explore agent-specific features in <a href="claude-code-sdk.html" class="xref page">Claude Code SDK</a></p>
</li>
<li>
<p>See real-world examples in <a href="../samples.html" class="xref page">Sample Agents</a></p>
</li>
</ul>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
