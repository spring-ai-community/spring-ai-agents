<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Claude Code SDK :: Spring AI Agents Reference</title>
    <link rel="canonical" href="https://spring-ai-community.github.io/spring-ai-agents/spring-ai-agents/main/api/claude-code-sdk.html">
    <meta name="generator" content="Antora 3.1.12">
    <link rel="stylesheet" href="../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://spring-ai-community.github.io/spring-ai-agents">Spring AI Agents Reference</a>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="spring-ai-agents" data-version="main">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">Spring AI Agents</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../getting-started.html">Getting Started</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="agentclient.html">AgentClient API</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="agentclient-vs-chatclient.html">AgentClient vs ChatClient</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="claude-code-sdk.html">Claude Code SDK</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="gemini-cli-sdk.html">Gemini CLI SDK</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../samples.html">Sample Agents</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../contribution-guidelines.html">Contribution Guidelines</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Spring AI Agents</span>
    <span class="version">main</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="../index.html">Spring AI Agents</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">main</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Spring AI Agents</a></li>
    <li><a href="agentclient.html">AgentClient API</a></li>
    <li><a href="claude-code-sdk.html">Claude Code SDK</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="file:///home/mark/claude/bud/experiments/spring-ai-agents/community-output/docs/src/main/antora/modules/ROOT/pages/api/claude-code-sdk.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Claude Code SDK</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_overview">1. Overview</a></li>
<li><a href="#_installation">2. Installation</a>
<ul class="sectlevel2">
<li><a href="#_prerequisites">2.1. Prerequisites</a></li>
<li><a href="#_maven_dependencies">2.2. Maven Dependencies</a></li>
</ul>
</li>
<li><a href="#_basic_usage">3. Basic Usage</a>
<ul class="sectlevel2">
<li><a href="#_quick_start">3.1. Quick Start</a></li>
</ul>
</li>
<li><a href="#_configuration">4. Configuration</a>
<ul class="sectlevel2">
<li><a href="#_claudecodeclient">4.1. ClaudeCodeClient</a></li>
<li><a href="#_claudecodeagentoptions">4.2. ClaudeCodeAgentOptions</a></li>
<li><a href="#_model_options">4.3. Model Options</a></li>
</ul>
</li>
<li><a href="#_advanced_features">5. Advanced Features</a>
<ul class="sectlevel2">
<li><a href="#_working_directory_management">5.1. Working Directory Management</a></li>
<li><a href="#_yolo_mode">5.2. YOLO Mode</a></li>
<li><a href="#_timeout_configuration">5.3. Timeout Configuration</a></li>
</ul>
</li>
<li><a href="#_error_handling">6. Error Handling</a>
<ul class="sectlevel2">
<li><a href="#_common_exceptions">6.1. Common Exceptions</a></li>
<li><a href="#_validation_and_recovery">6.2. Validation and Recovery</a></li>
</ul>
</li>
<li><a href="#_spring_boot_integration">7. Spring Boot Integration</a>
<ul class="sectlevel2">
<li><a href="#_auto_configuration">7.1. Auto-Configuration</a></li>
<li><a href="#_application_properties">7.2. Application Properties</a></li>
</ul>
</li>
<li><a href="#_best_practices">8. Best Practices</a>
<ul class="sectlevel2">
<li><a href="#_goal_formulation">8.1. Goal Formulation</a></li>
<li><a href="#_security_considerations">8.2. Security Considerations</a></li>
<li><a href="#_resource_management">8.3. Resource Management</a></li>
</ul>
</li>
<li><a href="#_troubleshooting">9. Troubleshooting</a>
<ul class="sectlevel2">
<li><a href="#_common_issues">9.1. Common Issues</a></li>
<li><a href="#_debugging">9.2. Debugging</a></li>
</ul>
</li>
<li><a href="#_next_steps">10. Next Steps</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The Claude Code SDK provides Java integration with Anthropic&#8217;s Claude Code CLI, enabling autonomous coding capabilities in Spring applications.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>1. Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Claude Code is Anthropic&#8217;s autonomous coding agent that can read, write, and execute code across entire codebases. The Spring AI Claude Code integration makes it easy to incorporate these capabilities into Java applications.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation"><a class="anchor" href="#_installation"></a>2. Installation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a>2.1. Prerequisites</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Install Claude Code CLI</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">npm install -g @anthropic-ai/claude-code</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Set API Key</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export ANTHROPIC_API_KEY="your-api-key-here"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Get your API key from the <a href="https://console.anthropic.com/">Anthropic Console</a>.</p>
</div>
</li>
<li>
<p><strong>Verify Installation</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">claude --version</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_maven_dependencies"><a class="anchor" href="#_maven_dependencies"></a>2.2. Maven Dependencies</h3>
<div class="paragraph">
<p>Add the following dependencies to your <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependencies&gt;
    &lt;!-- Core AgentClient API --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springaicommunity.agents&lt;/groupId&gt;
        &lt;artifactId&gt;spring-ai-agent-client&lt;/artifactId&gt;
        &lt;version&gt;0.1.0-SNAPSHOT&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;!-- Claude Code integration --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springaicommunity.agents&lt;/groupId&gt;
        &lt;artifactId&gt;spring-ai-claude-code&lt;/artifactId&gt;
        &lt;version&gt;0.1.0-SNAPSHOT&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_basic_usage"><a class="anchor" href="#_basic_usage"></a>3. Basic Usage</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_quick_start"><a class="anchor" href="#_quick_start"></a>3.1. Quick Start</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.springaicommunity.agents.client.AgentClient;
import org.springaicommunity.agents.client.AgentClientResponse;
import org.springaicommunity.agents.claudecode.ClaudeCodeAgentModel;
import org.springaicommunity.agents.claudecode.ClaudeCodeAgentOptions;
import org.springaicommunity.agents.claudecode.sdk.ClaudeCodeClient;

import java.nio.file.Paths;

public class ClaudeCodeExample {
    public static void main(String[] args) {
        // 1. Create the Claude Code client
        ClaudeCodeClient claudeClient = ClaudeCodeClient.create(
            Paths.get(System.getProperty("user.dir"))
        );

        // 2. Configure agent options
        ClaudeCodeAgentOptions options = ClaudeCodeAgentOptions.builder()
            .model("claude-sonnet-4-0")
            .yolo(true)
            .build();

        // 3. Create the agent model
        ClaudeCodeAgentModel agentModel = new ClaudeCodeAgentModel(claudeClient, options);

        // 4. Create AgentClient
        AgentClient agentClient = AgentClient.create(agentModel);

        // 5. Execute a goal
        AgentClientResponse response = agentClient.run(
            "Create a simple Calculator class with add, subtract, multiply, and divide methods"
        );

        System.out.println("Result: " + response.getResult());
        System.out.println("Success: " + response.isSuccessful());
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration"><a class="anchor" href="#_configuration"></a>4. Configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_claudecodeclient"><a class="anchor" href="#_claudecodeclient"></a>4.1. ClaudeCodeClient</h3>
<div class="paragraph">
<p>The <code>ClaudeCodeClient</code> manages communication with the Claude CLI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Create with default working directory
ClaudeCodeClient client = ClaudeCodeClient.create();

// Create with specific working directory
Path projectPath = Paths.get("/path/to/project");
ClaudeCodeClient client = ClaudeCodeClient.create(projectPath);

// Create with custom Claude command path
ClaudeCodeClient client = ClaudeCodeClient.create(
    projectPath,
    "/custom/path/to/claude"
);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_claudecodeagentoptions"><a class="anchor" href="#_claudecodeagentoptions"></a>4.2. ClaudeCodeAgentOptions</h3>
<div class="paragraph">
<p>Configure Claude-specific behavior:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ClaudeCodeAgentOptions options = ClaudeCodeAgentOptions.builder()
    // Model selection
    .model("claude-sonnet-4-0")  // or "claude-haiku-4-0"

    // Execution settings
    .yolo(true)                           // Allow modifications
    .timeout(Duration.ofMinutes(10))      // Execution timeout
    .maxTokens(8192)                      // Response length limit

    // Output preferences
    .verbose(true)                        // Detailed logging
    .outputFormat("json")                 // Structured output

    .build();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_model_options"><a class="anchor" href="#_model_options"></a>4.3. Model Options</h3>
<div class="paragraph">
<p>Available Claude models:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 50%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Model</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Best For</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claude-sonnet-4-0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Latest Sonnet model with enhanced coding capabilities</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Complex refactoring, large codebases, architectural changes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claude-haiku-4-0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Faster model optimized for speed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quick fixes, simple tasks, rapid prototyping</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claude-opus-4-0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Most capable model for complex reasoning</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Complex algorithms, system design, challenging debugging</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_advanced_features"><a class="anchor" href="#_advanced_features"></a>5. Advanced Features</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_working_directory_management"><a class="anchor" href="#_working_directory_management"></a>5.1. Working Directory Management</h3>
<div class="paragraph">
<p>Claude Code operates within a specific directory context:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Configure working directory via client
ClaudeCodeClient client = ClaudeCodeClient.create(
    Paths.get("/path/to/microservice")
);

// Or via AgentClient fluent API
AgentClientResponse response = agentClient
    .prompt("Add validation to the UserController")
    .workingDirectory("/path/to/microservice")
    .call();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_yolo_mode"><a class="anchor" href="#_yolo_mode"></a>5.2. YOLO Mode</h3>
<div class="paragraph">
<p>Control whether Claude can make changes without confirmation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Development mode - allow changes
ClaudeCodeAgentOptions devOptions = ClaudeCodeAgentOptions.builder()
    .yolo(true)
    .build();

// Analysis mode - read-only
ClaudeCodeAgentOptions analysisOptions = ClaudeCodeAgentOptions.builder()
    .yolo(false)
    .build();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_timeout_configuration"><a class="anchor" href="#_timeout_configuration"></a>5.3. Timeout Configuration</h3>
<div class="paragraph">
<p>Set appropriate timeouts for different goal complexities:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Quick tasks
ClaudeCodeAgentOptions quickOptions = ClaudeCodeAgentOptions.builder()
    .timeout(Duration.ofMinutes(2))
    .build();

// Complex refactoring
ClaudeCodeAgentOptions complexOptions = ClaudeCodeAgentOptions.builder()
    .timeout(Duration.ofMinutes(30))
    .build();</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_error_handling"><a class="anchor" href="#_error_handling"></a>6. Error Handling</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_common_exceptions"><a class="anchor" href="#_common_exceptions"></a>6.1. Common Exceptions</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">try {
    AgentClientResponse response = agentClient.run("Complex refactoring goal");

    if (!response.isSuccessful()) {
        System.err.println("Goal failed: " + response.getResult());
    }

} catch (ClaudeCodeExecutionException e) {
    // Claude CLI process failed
    System.err.println("Claude execution error: " + e.getMessage());

} catch (ClaudeCodeNotFoundException e) {
    // Claude CLI not installed or not in PATH
    System.err.println("Claude CLI not found: " + e.getMessage());

} catch (AgentTimeoutException e) {
    // Goal exceeded configured timeout
    System.err.println("Goal timed out: " + e.getTimeout());

} catch (AgentAuthenticationException e) {
    // Invalid or missing API key
    System.err.println("Authentication failed: " + e.getMessage());
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_validation_and_recovery"><a class="anchor" href="#_validation_and_recovery"></a>6.2. Validation and Recovery</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Service
public class ClaudeCodeService {

    private final AgentClient agentClient;

    public ClaudeCodeService(AgentClient agentClient) {
        this.agentClient = agentClient;
    }

    public String refactorCode(String className, String requirements) {
        // Validate inputs
        if (className == null || className.trim().isEmpty()) {
            throw new IllegalArgumentException("Class name is required");
        }

        try {
            // First, analyze the code
            AgentClientResponse analysis = agentClient
                .prompt("Analyze " + className + " and suggest improvements")
                .yolo(false) // Read-only analysis
                .call();

            if (!analysis.isSuccessful()) {
                throw new ServiceException("Analysis failed: " + analysis.getResult());
            }

            // Then perform refactoring
            AgentClientResponse refactoring = agentClient
                .prompt("Refactor " + className + " based on: " + requirements)
                .yolo(true) // Allow modifications
                .call();

            return refactoring.getResult();

        } catch (Exception e) {
            // Log error and return meaningful message
            log.error("Refactoring failed for class: {}", className, e);
            throw new ServiceException("Unable to refactor " + className + ": " + e.getMessage());
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_spring_boot_integration"><a class="anchor" href="#_spring_boot_integration"></a>7. Spring Boot Integration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_auto_configuration"><a class="anchor" href="#_auto_configuration"></a>7.1. Auto-Configuration</h3>
<div class="paragraph">
<p>Create a configuration class for Claude Code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
@ConditionalOnProperty(name = "spring.ai.agent.claude.enabled", havingValue = "true", matchIfMissing = true)
public class ClaudeCodeConfiguration {

    @Bean
    @ConditionalOnMissingBean
    public ClaudeCodeClient claudeCodeClient(@Value("${spring.ai.agent.claude.working-directory:#{systemProperties['user.dir']}}") String workingDir) {
        return ClaudeCodeClient.create(Paths.get(workingDir));
    }

    @Bean
    @ConditionalOnMissingBean
    public ClaudeCodeAgentModel claudeCodeAgentModel(
            ClaudeCodeClient client,
            ClaudeCodeAgentOptions options) {
        return new ClaudeCodeAgentModel(client, options);
    }

    @Bean
    @ConditionalOnMissingBean
    public ClaudeCodeAgentOptions claudeCodeAgentOptions(ClaudeCodeProperties properties) {
        return ClaudeCodeAgentOptions.builder()
            .model(properties.getModel())
            .yolo(properties.isYolo())
            .timeout(properties.getTimeout())
            .maxTokens(properties.getMaxTokens())
            .verbose(properties.isVerbose())
            .build();
    }

    @Bean
    public AgentClient agentClient(ClaudeCodeAgentModel agentModel) {
        return AgentClient.create(agentModel);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_application_properties"><a class="anchor" href="#_application_properties"></a>7.2. Application Properties</h3>
<div class="paragraph">
<p>Configure Claude Code via <code>application.yml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spring:
  ai:
    agent:
      claude:
        enabled: true
        model: claude-sonnet-4-0
        working-directory: /path/to/project
        yolo: false
        timeout: PT10M
        max-tokens: 8192
        verbose: true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or <code>application.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">spring.ai.agent.claude.enabled=true
spring.ai.agent.claude.model=claude-sonnet-4-0
spring.ai.agent.claude.working-directory=/path/to/project
spring.ai.agent.claude.yolo=false
spring.ai.agent.claude.timeout=PT10M
spring.ai.agent.claude.max-tokens=8192
spring.ai.agent.claude.verbose=true</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_best_practices"><a class="anchor" href="#_best_practices"></a>8. Best Practices</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_goal_formulation"><a class="anchor" href="#_goal_formulation"></a>8.1. Goal Formulation</h3>
<div class="paragraph">
<p>Write specific, actionable goals for Claude:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Good: Specific and contextual
agentClient.run("Add input validation to UserController.createUser() method using Bean Validation annotations");

// Good: Clear scope and requirements
agentClient.run("Refactor PaymentService to use the Strategy pattern for different payment processors");

// Avoid: Vague requests
agentClient.run("Fix the code");

// Avoid: Overly broad scope
agentClient.run("Rewrite the entire application");</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_security_considerations"><a class="anchor" href="#_security_considerations"></a>8.2. Security Considerations</h3>
<div class="paragraph">
<p>Always be cautious with YOLO mode in production:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Profile("development")
@Configuration
public class DevelopmentClaudeConfig {

    @Bean
    public ClaudeCodeAgentOptions devClaudeOptions() {
        return ClaudeCodeAgentOptions.builder()
            .yolo(true) // OK for development
            .build();
    }
}

@Profile("production")
@Configuration
public class ProductionClaudeConfig {

    @Bean
    public ClaudeCodeAgentOptions prodClaudeOptions() {
        return ClaudeCodeAgentOptions.builder()
            .yolo(false) // Safe for production
            .build();
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_resource_management"><a class="anchor" href="#_resource_management"></a>8.3. Resource Management</h3>
<div class="paragraph">
<p>Monitor and limit resource usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Component
public class ClaudeCodeMonitor {

    private final MeterRegistry meterRegistry;
    private final AgentClient agentClient;

    public ClaudeCodeMonitor(MeterRegistry meterRegistry, AgentClient agentClient) {
        this.meterRegistry = meterRegistry;
        this.agentClient = agentClient;
    }

    public String executeWithMetrics(String goal) {
        return Timer.Sample.start(meterRegistry)
            .stop(Timer.builder("claude.goal.duration")
                .tag("goal", goal.substring(0, Math.min(goal.length(), 50)))
                .register(meterRegistry))
            .recordCallable(() -&gt; {
                Counter.builder("claude.goal.count").register(meterRegistry).increment();

                AgentClientResponse response = agentClient.run(goal);

                Counter.builder("claude.goal.result")
                    .tag("success", String.valueOf(response.isSuccessful()))
                    .register(meterRegistry)
                    .increment();

                return response.getResult();
            });
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_troubleshooting"><a class="anchor" href="#_troubleshooting"></a>9. Troubleshooting</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_common_issues"><a class="anchor" href="#_common_issues"></a>9.1. Common Issues</h3>
<div class="paragraph">
<p><strong>Claude CLI Not Found</strong></p>
</div>
<div class="paragraph">
<p>Ensure Claude is installed and in your PATH:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Verify installation
claude --version

# Check PATH
which claude  # macOS/Linux
where claude  # Windows

# Reinstall if needed
npm install -g @anthropic-ai/claude-code</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>API Key Issues</strong></p>
</div>
<div class="paragraph">
<p>Verify your API key configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Check environment variable
echo $ANTHROPIC_API_KEY

# Test with Claude CLI directly
claude --help</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Permission Denied</strong></p>
</div>
<div class="paragraph">
<p>Ensure proper file permissions in working directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Check directory permissions
ls -la /path/to/project

# Fix if needed
chmod -R u+rw /path/to/project</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Timeout Issues</strong></p>
</div>
<div class="paragraph">
<p>Increase timeout for complex tasks:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ClaudeCodeAgentOptions options = ClaudeCodeAgentOptions.builder()
    .timeout(Duration.ofMinutes(30)) // Longer timeout
    .build();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_debugging"><a class="anchor" href="#_debugging"></a>9.2. Debugging</h3>
<div class="paragraph">
<p>Enable verbose logging to troubleshoot issues:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ClaudeCodeAgentOptions debugOptions = ClaudeCodeAgentOptions.builder()
    .verbose(true)
    .build();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add logging configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">logging:
  level:
    org.springaicommunity.agents.claudecode: DEBUG
    org.springaicommunity.agents.client: DEBUG</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_next_steps"><a class="anchor" href="#_next_steps"></a>10. Next Steps</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Learn about other agent integrations in <a href="gemini-cli-sdk.html" class="xref page">Gemini CLI SDK</a></p>
</li>
<li>
<p>See practical examples in <a href="../samples.html" class="xref page">Sample Agents</a></p>
</li>
<li>
<p>Compare with the standard API in <a href="agentclient-vs-chatclient.html" class="xref page">AgentClient vs ChatClient</a></p>
</li>
</ul>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
